echo "ğŸ” Running pre-commit checks..."
echo ""

# Bump version if needed
echo "ğŸ“¦ Bumping version if needed..."
echo ""

# Run linters via lint-staged (graceful fallback)
echo "ğŸ“ Running linters..."
if command -v lint-staged > /dev/null 2>&1; then
  lint-staged
elif npx --no-install lint-staged --version > /dev/null 2>&1; then
  npx --no-install lint-staged
else
  echo "âš ï¸  lint-staged not found, skipping..."
fi
echo ""

# Check for TypeScript compilation errors in changed packages only
echo "ğŸ“¦ Type checking (build)..."

# Use turbo to build only affected packages
if ! pnpm exec turbo build --affected 2>&1 > /dev/null; then
  echo "âŒ Build failed! Fix compilation errors before committing."
  exit 1
fi

echo ""
echo "âœ… All checks passed!"
